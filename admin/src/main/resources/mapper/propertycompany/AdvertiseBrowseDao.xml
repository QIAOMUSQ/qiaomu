<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qiaomu.modules.propertycompany.dao.AdvertiseBrowseDao">


    <insert id="insertOrUpdate" parameterType="com.qiaomu.modules.propertycompany.entity.AdvertiseBrowse">
      INSERT INTO yw_advertise_browse(
          advertise_id,
          date,
          browse_person
      )VALUES (
          #{advertiseId},
          #{date},
          #{browsePerson}
      ) ON DUPLICATE KEY UPDATE
      browse_person = values(browse_person)
    </insert>
    <select id="getStatistics" resultType="com.qiaomu.modules.propertycompany.entity.AdvertiseBrowse"
            parameterType="com.qiaomu.modules.propertycompany.entity.AdvertiseBrowse">
    SELECT
        SUM(b.browse_person) as browse_person,a.title as advertiseName
    FROM
        yw_advertise_browse b
    LEFT JOIN yw_advertise a ON a.id = b.advertise_id
    WHERE b.date >=#{startTime} and b.date &lt;= #{endTime}
        GROUP BY a.title
    ORDER BY b.browse_person DESC
    </select>
    <select id="getStatisticsDetail" resultType="com.qiaomu.modules.propertycompany.entity.AdvertiseBrowse"
            parameterType="com.qiaomu.modules.propertycompany.entity.AdvertiseBrowse">
    SELECT
        b.browse_person,a.title as advertiseName,b.date
    FROM
        yw_advertise_browse b
    LEFT JOIN yw_advertise a ON a.id = b.advertise_id
    WHERE b.date >=#{startTime} and b.date &lt;= #{endTime} and
      a.title = #{advertiseName}
    ORDER BY b.date DESC
    </select>
</mapper>